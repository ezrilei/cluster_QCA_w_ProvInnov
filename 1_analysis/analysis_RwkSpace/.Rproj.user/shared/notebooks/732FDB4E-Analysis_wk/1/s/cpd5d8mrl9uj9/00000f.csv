"0","plot_PIMS_radar <- function(Region_Target) {"
"0","  library(dplyr)"
"0","  library(tidyr)"
"0","  library(ggplot2)"
"0","  library(stringr)"
"0","  # install.packages(""devtools"")"
"0","  # devtools::install_github(""ricardo-bion/ggradar"")"
"0","  library(ggradar)"
"0","  library(scales)"
"0","  library(showtext)"
"0",""
"0","  # 中文支持"
"0","  showtext_auto(enable = TRUE)"
"0","  font_add(""fangSong"", regular = ""./fonts/方正仿宋_GBK.TTF"")"
"0","  font_add(""TimesNewRoman"", regular = ""./fonts/Times New Roman.ttf"")"
"0",""
"0","  # 地区名"
"0","  region_target <- Region_Target"
"0",""
"0","  # 数据准备 ------------------------------------"
"0","  df_pims_region <- df_PIMS %>%"
"0","    filter(str_detect(CASE, region_target)) %>%"
"0","    mutate(Year = as.integer(str_extract(CASE, ""\\d{4}""))) %>%"
"0","    arrange(Year)"
"0",""
"0","  df_pims_region_long <- df_pims_region %>%"
"0","    pivot_longer("
"0","      cols = -c(CASE, Year),"
"0","      names_to = ""Pathway"","
"0","      values_to = ""Membership"""
"0","    )"
"0",""
"0","  df_radar <- df_pims_region_long %>%"
"0","    group_by(Pathway, Year) %>%"
"0","    summarise(Membership = mean(Membership, na.rm = TRUE), .groups = ""drop"") %>%"
"0","    pivot_wider(names_from = Year, values_from = Membership) %>%"
"0","    rename(Path = Pathway)"
"0",""
"0","  df_radar[is.na(df_radar)] <- 0  # 可选处理缺失值"
"0",""
"0","  # 绘图并保存 ------------------------------------"
"0","  p_case_pims_radar <- ggradar(df_radar,"
"0","                               "
"0","                               font.radar = ""fangSong"","
"0","                               "
"0","                               # The labels of the grid"
"0","                               values.radar = c(""0"", ""0.5"", ""1""),"
"0","                               grid.min = 0, grid.mid = 0.5, grid.max = 1,"
"0","                               group.line.width = 0.5,"
"0","                               group.point.size = 2,"
"0","                               axis.label.size = 5,"
"0","                               "
"0","                               "
"0","                               background.circle.colour = ""white"","
"0","                               axis.line.colour = ""gray60"","
"0","                               gridline.min.colour = ""gray60"","
"0","                               gridline.mid.colour = ""gray60"","
"0","                               gridline.max.colour = ""gray60"","
"0","                               group.colours = c(""#f8766d"", ""#7cae00"", ""#00bfc4"", ""#c77cff""),"
"0","                               "
"0","                               legend.position = ""bottom"","
"0","                               legend.text.size = 10,"
"0","                               "
"0","                               fill = TRUE,"
"0","                               fill.alpha = 0.075,"
"0","                               "
"0","                               plot.title = paste0(""路径隶属度演化（"", region_target, ""）""))+"
"0",""
"0","    #theme_bw(base_family = ""TimesNewRoman"") +"
"0","    theme("
"0","      text = element_text(family = ""fangSong""),"
"0","      axis.title = element_text(family = ""fangSong"", size = 14),"
"0","      legend.title = element_text(family = ""fangSong"", size = 12),"
"0","      # 图例标题"
"0","      legend.text = element_text(family = ""fangSong"", size = 10),"
"0","      # 图例标签"
"0","      legend.position = ""bottom"","
"0","      #plot.margin = unit(c(1, 4, 1, 1), ""cm"")"
"0","    ) +"
"0","    guides(color = guide_legend(ncol = 1))"
"0",""
"0","  # 保存 PDF"
"0","  ggsave("
"0","    filename = paste0(""./output/【Analysis_wk】3.充分性分析_路径模糊集隶属度（"", "
"0","                      region_target, "
"0","                      ""）_雷达图.pdf""),"
"0","    plot = p_case_pims_radar,"
"0","    width = 10,"
"0","    height = 10"
"0","  )"
"0",""
"0","  return(p_case_pims_radar)"
"0","}"
