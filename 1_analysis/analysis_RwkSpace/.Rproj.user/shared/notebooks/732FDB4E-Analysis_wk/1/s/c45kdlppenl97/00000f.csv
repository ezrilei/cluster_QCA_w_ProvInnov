"0","# 加载必要包"
"0","library(dplyr)"
"0","library(tidyr)"
"0","library(stringr)"
"0","library(fmsb)"
"0",""
"0","region_target <- ""湖北"""
"0",""
"0","# show CN text"
"0","library(showtext) #https://github.com/yixuan/showtext"
"0","showtext_auto(enable = TRUE)"
"0","font_add(""fangSong"", regular = ""./fonts/方正仿宋_GBK.TTF"") # <<<<<<<<<<<<<<"
"0","font_add(""TimesNewRoman"", regular = ""./fonts/Times New Roman.ttf"")"
"0",""
"0","# store to pdf (create a pdf device) ---------------"
"0","pdf(file = paste0(""./output/【Analysis_wk】3.充分性分析_路径模糊集隶属度（"", "
"0","                  region_target,"
"0","                  ""）_雷达图.pdf""), width = 10, height = 8)"
"0",""
"0"," # 1. 筛选该地区的数据"
"0","  df_region <- df_PIMS %>%"
"0","    filter(str_detect(CASE, region_target)) %>%"
"0","    mutate(Year = str_extract(CASE, ""\\d{4}"")) %>%"
"0","    arrange(Year)"
"0","  "
"0","  # 2. 重整数据：每个路径为一行，每个年份为一列"
"0","  df_radar <- df_region %>%"
"0","    select(-CASE) %>%"
"0","    pivot_longer(-Year, names_to = ""Pathway"", values_to = ""Membership"") %>%"
"0","    pivot_wider(names_from = Year, values_from = Membership)"
"0",""
"0","  # 3. 添加 fmsb 所需的最大值 & 最小值行"
"0","  df_radar_plot <- rbind("
"0","    rep(1, ncol(df_radar) - 1),  # 最大值"
"0","    rep(0, ncol(df_radar) - 1),  # 最小值"
"0","    df_radar[, -1]               # 实际数据（去掉 Pathway）"
"0","  )"
"0","  "
"0","  # 4. 设置颜色"
"0","  colors_border <- rainbow(nrow(df_radar))"
"0","  colors_fill <- adjustcolor(colors_border, alpha.f = 0.2)"
"0",""
"0","  # 5. 绘图"
"0","  radarchart(df_radar_plot,"
"0","             axistype = 1,"
"0","             pcol = colors_border,"
"0","             pfcol = colors_fill,"
"0","             plwd = 2,"
"0","             plty = 1,"
"0","             cglcol = ""grey"","
"0","             cglty = 1,"
"0","             axislabcol = ""black"","
"0","             caxislabels = seq(0, 1, 0.2),"
"0","             vlcex = 0.8,"
"0","             title = paste0(""路径隶属度演化"", ""（"", region_target, ""）"") "
"0","             )"
