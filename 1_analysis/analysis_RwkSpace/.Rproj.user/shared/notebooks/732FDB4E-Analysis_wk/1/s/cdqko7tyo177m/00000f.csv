"0","plot_PIMS <- function(Region_Target){"
"0","  # 加载包"
"0","library(dplyr)"
"0","library(tidyr)"
"0","library(ggplot2)"
"0","# library(stringr)"
"0",""
"0","# 设定地区名称（你只需要改这行）"
"0","region_target <- Region_Target "
"0",""
"0","# 筛选该地区的所有案例（如 湖北_2016、湖北_2017）"
"0","df_pims_region <- df_PIMS %>%"
"0","  filter(stringr::str_detect(CASE, region_target)) %>%"
"0","  mutate(Year = as.integer(stringr::str_extract(CASE, ""\\d{4}"")))  # 提取年份"
"0",""
"0","# 数据转换为长格式（路径做变量，方便 ggplot）"
"0","df_pims_region_long <- df_pims_region %>%"
"0","  pivot_longer("
"0","    cols = -c(CASE, Year),"
"0","    names_to = ""Pathway"","
"0","    values_to = ""Membership"""
"0","  )"
"0",""
"0","# 绘图 ----"
"0","# show CN text"
"0","library(showtext) #https://github.com/yixuan/showtext"
"0","showtext_auto(enable = TRUE)"
"0","font_add(""fangSong"", regular = ""./fonts/方正仿宋_GBK.TTF"") # <<<<<<<<<<<<<<"
"0","font_add(""TimesNewRoman"", regular = ""./fonts/Times New Roman.ttf"")"
"0",""
"0",""
"0","# store to pdf (create a pdf device) ---------------"
"0","# pdf(file = ""./output_manual/组间一致性水平趋势图.pdf"", width = 10, height = 8)"
"0","pdf(file = paste0(""./output/【Analysis_wk】3.充分性分析_路径模糊集隶属度（"", "
"0","                  region_target,"
"0","                  ""）.pdf""), width = 10, height = 8)"
"0",""
"0",""
"0","# 绘图：路径随时间变化图（每条路径一条线）----"
"0","p_case_pims <- ggplot(df_pims_region_long, aes(x = Year, y = Membership, color = Pathway)) +"
"0","  geom_line(size = 0.5) +"
"0","  geom_point(size = 1) +"
"0","  geom_hline(yintercept = 0.5, linetype = ""dashed"", color = ""gray50"") +"
"0","  scale_y_continuous(limits = c(0, 1)) +"
"0","  scale_x_continuous(breaks = sort(unique(df_pims_region_long$Year))) +"
"0","  labs("
"0","    title = paste0(""路径隶属度演化"", ""（"", region_target, ""）""),"
"0","    #subtitle = ""每条线代表一个路径组态的 fuzzy membership 值"","
"0","    x = ""年份"","
"0","    y = ""模糊集隶属度得分"","
"0","    color = ""因果路径"""
"0","  ) +"
"0","  "
"0","  theme_bw(base_family = ""TimesNewRoman"") +"
"0","  theme("
"0","    text = element_text(family = ""fangSong""),"
"0","    axis.title = element_text(family = ""fangSong"", size = 14),"
"0","    legend.title = element_text(family = ""fangSong"", size = 12),  # 图例标题"
"0","    legend.text = element_text(family = ""fangSong"", size = 10),   # 图例标签"
"0","    legend.position = ""bottom"","
"0","    plot.margin = unit(c(1, 4, 1, 1), ""cm"")"
"0","  ) +"
"0","  guides("
"0","    color = guide_legend(ncol = 1)"
"0","    #linetype = guide_legend(ncol = 1)"
"0","    #linetype = guide_legend(override.aes = list(color = ""black""))"
"0","  )"
"0",""
"0",""
"0","print(p_case_pims)"
"0","dev.off()"
"0",""
"0","p_case_pims"
"0","}"
"0",""
